<html>
    <head><base target="_blank"><link rel="stylesheet" type="text/css" href="https://app.wandb.ai/normalize.css" />
    <meta charset="UTF-8">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400&display=swap');

        body {
            font-family: 'Arial', sans-serif;
        }
        .container {
            max-width: 960px;
            margin: auto;
            padding: 10px;
            text-align: center;
        }
        .row {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }
        .cell {
            position: relative;
            margin: 0 5px;
            padding: 10px;
            min-width: 40px;
            min-height: 40px;
            background: #f4f4f4;
            border-radius: 6px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .cell:hover {
            background: #ffeb3b;
            z-index: 2;
        }
        .input-cell {
            font-family: 'Arial', sans-serif;
        }
        .output-cell {
            font-family: 'Noto Sans Devanagari', sans-serif;
        }
        .prediction-box {
            position: absolute;
            display: none;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 180px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 10;
            padding: 10px;
            font-size: 14px;
            text-align: left;
        }
        .cell:hover .prediction-box {
            display: block;
        }
        .prediction-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .bar {
            height: 6px;
            border-radius: 3px;
            background: #4caf50;
            margin-top: 2px;
        }
        .connections {
            position: relative;
            height: 30px;
        }
        .line {
            position: absolute;
            height: 2px;
            background: green;
            transform-origin: left center;
            transition: 0.2s;
            opacity: 0.6;
        }
        .slider-container {
            margin: 10px;
        }
    </style>
    </head>
    <body>
    <div class="container">
            <div class="title">Transliteration Attention Connectivity</div>
            <div class="instructions">
                Hover over any character to see its connections. 
                The green lines show the attention weights: stronger connections have darker green lines.
                Hover over output characters to see top prediction alternatives.
                Use the threshold slider to filter the connections by strength.
            </div>
            
            <div class="controls">
                <div class="slider-container">
                    <span class="slider-label">Threshold:</span>
                    <input type="range" id="threshold-slider" min="0" max="1" step="0.05" value="0.1">
                    <span id="threshold-value">0.1</span>
                </div>
            </div>
            
            <div class="model-type">Sequence-to-Sequence with Attention [ LSTM ]</div>
            <div class="visualization">
                <div class="row input-row">
    <div class="cell input-cell" id="in-0">b</div><div class="cell input-cell" id="in-1">h</div><div class="cell input-cell" id="in-2">u</div><div class="cell input-cell" id="in-3">l</div><div class="cell input-cell" id="in-4">a</div><div class="cell input-cell" id="in-5">n</div><div class="cell input-cell" id="in-6">e</div></div><div class="connections"><div class="line" data-from="0" data-to="0" data-weight="0.0245"></div><div class="line" data-from="1" data-to="0" data-weight="0.2185"></div><div class="line" data-from="2" data-to="0" data-weight="0.7427"></div><div class="line" data-from="3" data-to="0" data-weight="0.0127"></div><div class="line" data-from="4" data-to="0" data-weight="0.0011"></div><div class="line" data-from="5" data-to="0" data-weight="0.0002"></div><div class="line" data-from="6" data-to="0" data-weight="0.0001"></div><div class="line" data-from="0" data-to="1" data-weight="0.0000"></div><div class="line" data-from="1" data-to="1" data-weight="0.0010"></div><div class="line" data-from="2" data-to="1" data-weight="0.0622"></div><div class="line" data-from="3" data-to="1" data-weight="0.9137"></div><div class="line" data-from="4" data-to="1" data-weight="0.0226"></div><div class="line" data-from="5" data-to="1" data-weight="0.0005"></div><div class="line" data-from="6" data-to="1" data-weight="0.0000"></div><div class="line" data-from="0" data-to="2" data-weight="0.0000"></div><div class="line" data-from="1" data-to="2" data-weight="0.0000"></div><div class="line" data-from="2" data-to="2" data-weight="0.0000"></div><div class="line" data-from="3" data-to="2" data-weight="0.3797"></div><div class="line" data-from="4" data-to="2" data-weight="0.6157"></div><div class="line" data-from="5" data-to="2" data-weight="0.0044"></div><div class="line" data-from="6" data-to="2" data-weight="0.0001"></div><div class="line" data-from="0" data-to="3" data-weight="0.0000"></div><div class="line" data-from="1" data-to="3" data-weight="0.0000"></div><div class="line" data-from="2" data-to="3" data-weight="0.0000"></div><div class="line" data-from="3" data-to="3" data-weight="0.0012"></div><div class="line" data-from="4" data-to="3" data-weight="0.0405"></div><div class="line" data-from="5" data-to="3" data-weight="0.9379"></div><div class="line" data-from="6" data-to="3" data-weight="0.0204"></div><div class="line" data-from="0" data-to="4" data-weight="0.0000"></div><div class="line" data-from="1" data-to="4" data-weight="0.0000"></div><div class="line" data-from="2" data-to="4" data-weight="0.0000"></div><div class="line" data-from="3" data-to="4" data-weight="0.0000"></div><div class="line" data-from="4" data-to="4" data-weight="0.0000"></div><div class="line" data-from="5" data-to="4" data-weight="0.0253"></div><div class="line" data-from="6" data-to="4" data-weight="0.9054"></div><div class="line" data-from="0" data-to="5" data-weight="0.0000"></div><div class="line" data-from="1" data-to="5" data-weight="0.0000"></div><div class="line" data-from="2" data-to="5" data-weight="0.0000"></div><div class="line" data-from="3" data-to="5" data-weight="0.0000"></div><div class="line" data-from="4" data-to="5" data-weight="0.0000"></div><div class="line" data-from="5" data-to="5" data-weight="0.0000"></div><div class="line" data-from="6" data-to="5" data-weight="0.0025"></div></div><div class="row output-row"><div class="cell output-cell" id="out-0">भ<div class="prediction-box"><strong>Top Predictions</strong><br><div class="prediction-item"><span>भ</span><span>1.00</span></div><div class="bar" style="width:99%;"></div><div class="prediction-item"><span>ब</span><span>0.00</span></div><div class="bar" style="width:0%;"></div><div class="prediction-item"><span>झ</span><span>0.00</span></div><div class="bar" style="width:0%;"></div></div></div><div class="cell output-cell" id="out-1">ु<div class="prediction-box"><strong>Top Predictions</strong><br><div class="prediction-item"><span>ु</span><span>0.60</span></div><div class="bar" style="width:60%;"></div><div class="prediction-item"><span>ू</span><span>0.37</span></div><div class="bar" style="width:36%;"></div><div class="prediction-item"><span>ल</span><span>0.03</span></div><div class="bar" style="width:2%;"></div></div></div><div class="cell output-cell" id="out-2">ल<div class="prediction-box"><strong>Top Predictions</strong><br><div class="prediction-item"><span>ल</span><span>0.99</span></div><div class="bar" style="width:98%;"></div><div class="prediction-item"><span>न</span><span>0.00</span></div><div class="bar" style="width:0%;"></div><div class="prediction-item"><span>ट</span><span>0.00</span></div><div class="bar" style="width:0%;"></div></div></div><div class="cell output-cell" id="out-3">ा<div class="prediction-box"><strong>Top Predictions</strong><br><div class="prediction-item"><span>ा</span><span>0.51</span></div><div class="bar" style="width:50%;"></div><div class="prediction-item"><span>न</span><span>0.47</span></div><div class="bar" style="width:46%;"></div><div class="prediction-item"><span>ल</span><span>0.01</span></div><div class="bar" style="width:1%;"></div></div></div><div class="cell output-cell" id="out-4">न<div class="prediction-box"><strong>Top Predictions</strong><br><div class="prediction-item"><span>न</span><span>0.78</span></div><div class="bar" style="width:77%;"></div><div class="prediction-item"><span>े</span><span>0.18</span></div><div class="bar" style="width:18%;"></div><div class="prediction-item"><span>ा</span><span>0.02</span></div><div class="bar" style="width:2%;"></div></div></div><div class="cell output-cell" id="out-5">े<div class="prediction-box"><strong>Top Predictions</strong><br><div class="prediction-item"><span>े</span><span>0.74</span></div><div class="bar" style="width:73%;"></div><div class="prediction-item"><span><eos></span><span>0.24</span></div><div class="bar" style="width:24%;"></div><div class="prediction-item"><span>न</span><span>0.01</span></div><div class="bar" style="width:1%;"></div></div></div>
        </div>
    </div>
    <script>
        const updateLines = () => {
            const threshold = parseFloat(document.getElementById('thresh-slider').value);
            document.getElementById('thresh-value').innerText = threshold.toFixed(2);

            document.querySelectorAll('.line').forEach(line => {
                const from = document.getElementById('in-' + line.dataset.from);
                const to = document.getElementById('out-' + line.dataset.to);
                const rect1 = from.getBoundingClientRect();
                const rect2 = to.getBoundingClientRect();
                const weight = parseFloat(line.dataset.weight);
                if (weight < threshold) {
                    line.style.display = 'none';
                    return;
                }
                line.style.display = 'block';
                const x1 = rect1.left + rect1.width / 2;
                const y1 = rect1.bottom;
                const x2 = rect2.left + rect2.width / 2;
                const y2 = rect2.top;
                const dx = x2 - x1;
                const dy = y2 - y1;
                const length = Math.sqrt(dx*dx + dy*dy);
                const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                line.style.width = length + 'px';
                line.style.left = (x1 - from.parentElement.getBoundingClientRect().left) + 'px';
                line.style.top = (y1 - from.parentElement.getBoundingClientRect().top) + 'px';
                line.style.transform = 'rotate(' + angle + 'deg)';
                line.style.opacity = weight;
            });
        };

        window.addEventListener('load', updateLines);
        window.addEventListener('resize', updateLines);
        document.getElementById('thresh-slider').addEventListener('input', updateLines);
    </script>
    </body>
    </html>